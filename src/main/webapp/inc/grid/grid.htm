<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>表格控件</title>
<script language="javascript" src="grid.js"></script>
<script language="javascript" src="prototype.js"></script>
<link rel="stylesheet" type="text/css" href="grid.css"/>
</head>

<body onLoad="init()">
<table width="100%"  border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td id="dContainerTD" width="100%"><div id="dContainer"></div></td>
	<td>&nbsp;</td>
    <td><div id="dContainer1"></div></td>
  </tr>
  <tr>
    <td colspan="3">&nbsp;</td>
  </tr>
  <tr>
    <td colspan="3">
	<input type="button" name="Submit" value="getChecked" onClick="getChecked()">&nbsp;&nbsp;
    <input type="button" name="Submit" value="getPicked" onClick="getPicked()">
    &nbsp;&nbsp;
    <input name="export Excel" type="button" id="export Excel" onClick="exportExcel()" value="export Excel">
    &nbsp;&nbsp;
    <input type="button" name="Submit" value="export Word" onClick="exportWord()"></td>
  </tr>
</table>
</body>
</html>
<script>
var grid;
function init(){
    var titleData = [{name:"name1", text:"列表一", width:"100px", visible:true, sortable:true, dataType:"string"},
	                 {name:"name2", text:"列表二", width:"100px", visible:true, sortable:true, dataType:"string"},
					 {name:"name3", text:"列表三", width:"100px", visible:true, sortable:true, dataType:"string"},
					 {name:"name4", text:"列表四", width:"100px", visible:true, sortable:true, dataType:"string"},
					 {name:"name5", text:"列表五", width:"100px", visible:true, sortable:true, dataType:"string"}
	                 ]
					 
    grid = new Grid({id: "dContainer",
	                      width: "800px",
						  height: 350,
						  showCheckbox: true,
						  showSequence: true,
						  adaptOutline: false,
						  showPage: true,
						  whiteSpace: "normal",
						  isRender: true,
						  titleData: titleData,
						  page: {pageIndex:1,pageSize:20,pageCount:3,recordCount:100},
						  imgPath: "images/",
						  attachSvc: "makeData"
						  });

	//grid.load(makeData(20));	
	//grid.loadByPage(makeData(20));	
	
	/*
	grid.reLoad = function(pageIndex, pageSize){
	    grid.load(makeData(1, 15));
	}
	*/
	
		
	grid.doClick = function(obj){
	     //alert(obj["name1"]);
	}
	
	grid.doDblClick = function(obj){
	    for(p in obj)alert(p + ":" + obj[p]);
	}
	
	grid.doContextMenu = function(obj, evt){
	    var menu = grid.showContextMenu(evt);
	    var item1 = menu.addItem("添加操作一");
	    var item2 = menu.addItem("添加操作二");
	    item1.doClick = function(){
	        alert("操作一: " + obj.name1);
	    }
	    item2.doClick = function(){
	        alert("操作二: " + obj.name2);
	    }
    }
	
	//grid.sortRule = function(a, b){
	    
	//}
	
	/*
	var grid1 = new Grid({id: "dContainer1",
	                      width: 500,
						  height: 350,
						  showCheckbox: true,
						  showSequence: true,
						  showPage: true,
						  whiteSpace: "nowrap",
						  titleData: titleData,
						  page: {pageIndex:1,pageSize:20,pageCount:3,recordCount:100},
						  imgPath: "images/"
						  });

	grid1.load(testData);		
	*/  
	
}

function getChecked(){
    var arr = grid.getChecked();
	alert(arr.length);
}

function getPicked(){
    var obj = grid.getPicked();
	for(p in obj)alert(p + ":" + obj[p]);
}

function exportExcel(){
    grid.exportExcel();
}

function exportWord(){
    grid.exportWord();
}

function makeData(index, size){
    size = size || "10";
    var testData = new Array(); 
	  for(var i=0; i<size; i++)
	  {
		var recordData = new Object();
		recordData.name1 = "row-"+i;
		recordData.name2 = "永远的一班swg-"+index;
		recordData.name3 = "女";
		recordData.name4 = "85";
		recordData.name5 = "永远的一班!";   
		testData.push(recordData);
	  }
	  return testData;
}

</script>
                                                                                              
