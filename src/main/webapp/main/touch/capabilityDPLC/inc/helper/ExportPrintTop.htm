<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>打印输出Excel</title>
<style type="text/css">
<!--
.td_blue_line {background-color: #94B1ED;}
.td_blue_txt {color: #003399; background-color: #CEE3FF;}
.button_blue{margin:1 2 1 2; border-right:1 solid #5AA9FF; border-top:1 solid #FFFFFF; border-left:1 solid #FFFFFF; border-bottom:1 solid #5AA9FF; font-size:12; color:#003399; padding-top:2; background:#BDE5FF;}
-->
</style>
</head>

<body style="margin:0" scroll="no" onunload="ga.close()">
		<table width="100%" border="0" cellpadding="2" cellspacing="1">
		  <tr>
		    <td height="1" class="td_blue_line"><img src="images/shim.gif" width="1" height="1"></td>
		  </tr>
		  <tr>
		    <td class="td_blue_txt" height="40" align="center">
		      <input name="btn1" type="button" class="button_blue" id="btn1" onClick="fc()" value="打印预览">
		      <input name="btn2" type="button" class="button_blue" id="btn2" onClick="fd()" value="打 印">
			  	<input name="btn6" type="button" class="button_blue" id="btn6" onClick="fe()" value="设置宽度比例">
		      <input name="btn3" type="button" class="button_blue" id="btn3" onClick="fb(window.prompt('请输入报表标题',''))" value="设置标题">
		      <input name="btn4" type="button" class="button_blue" id="btn4" onClick="ff()" value="导出Excel">
		      <input name="btn5" type="button" class="button_blue" id="btn5" onClick="window.close()" value="关闭窗口">
		      <input type="hidden" id="pageMark" name="pageMark" style="behavior:url(#default#userData)">
		    </td>
		  </tr>
		  <tr>
		    <td height="1" class="td_blue_line"><img src="images/shim.gif" width="1" height="1"></td>
		  </tr>
		</table>

</body>
</html>
<script language="javascript">
<!--
var ga=window.dialogArguments;var gb=fj("tlnm");var gc=fj("mode");fa();function fa(){var prtObj=ga.opener.document.all(gb);if(!prtObj)return;switch(parseInt(gc)){case 0:ga.document.body.innerHTML=fi(prtObj,0);break;case 2:ga.document.body.innerHTML=prtObj.outerHTML;var _bodyTbl=ga.document.all(gb);_bodyTbl.border="0";_bodyTbl.cellPadding="0";_bodyTbl.cellSpacing="0";_bodyTbl.align="center";_bodyTbl.borderColor="#666666";_bodyTbl.style.borderCollapse="collapse";_bodyTbl.style.tableLayout="fixed";break;};fb(ga.opener.document.title);ga.document.body.style.cursor='default';};function fb(inStr){if(inStr){var winTitleO=ga.document.all.tit1;if(winTitleO)winTitleO.innerText=inStr;};};function fc(){fg();ga.document.all.WebBrowser.ExecWB(7,1);};function fd(){fg();ga.document.all.WebBrowser.ExecWB(6,1);};function fe(){var recStr=window.prompt('请输入20～150的比例数字','100');if(recStr==null)return;var recNum=Trim(recStr||"");if(isNaN(recNum))fe();else{if(recNum>19&&recNum<151)fl(parseInt(recNum));else fe();};};function ff(){ga.document.all.WebBrowser.ExecWB(17,1);ga.document.execCommand('Copy');if(ga.document.body.innerHTML!="")fh();window.clipboardData.setData('Text',"");};function fg(){var pmO=document.all.pageMark;pmO.load("oXMLBranch");if(pmO.getAttribute("sPersist")==null){var hkey_root,hkey_path,hkey_key;hkey_root="HKEY_CURRENT_USER";hkey_path="\\Software\\Microsoft\\Internet Explorer\\PageSetup";try{var RegWsh=new ActiveXObject("WScript.Shell");}catch(e){alert("请把本系统加入到信任站点，才能使用该功能！");return;}hkey_key="\\header";RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"");hkey_key="\\footer";RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"");pmO.setAttribute("sPersist","1");pmO.save("oXMLBranch");};};function fh(){var oXL;try{oXL=new ActiveXObject("Excel.Application");}catch(e){alert("请把本系统加入到信任站点，才能使用该功能！");return;};var oWB=oXL.Workbooks.Add();var oSheet=oWB.ActiveSheet;oSheet.Paste();oXL.Visible=true;oXL.UserControl=true;oSheet.Columns("A:AZ").AutoFit();oSheet.Range("A1:A1").Select();oSheet=null;oWB=null;oXL=null;};function fi(prtObj,pMode){var _tArr=new Array("<table x:str border='0' cellpadding='0' cellspacing='0' align='center' style='border-collapse:collapse;table-layout:fixed;'><colGroup>");var headStr="<tr>";var tmpObj=prtObj._perl_.rows(0);var i=0,j=0;var len=tmpObj.cells.length;var rLen=prtObj._perl_.rows.length;for(i=0;i<len;i++){headStr+="<td class=xl27>"+tmpObj.cells(i).innerText+"</td>";_tArr.push(fk(tmpObj.cells(i).style.width));};headStr+="</tr>";_tArr.push("</colGroup><thead><tr height='41' style='mso-height-source:userset;height:30.75pt'><td colspan='"+len+"' height='41' class='xl29' style='height:30.75pt;' id='tit1'></td></tr>");_tArr.push(headStr+"</thead><tbody>");if(rLen>1){if(pMode>0){}else{tmpObj=prtObj._perl_.rows;for(i=1;i<rLen;i++){_tArr.push("<tr><td class=xl24>");headStr=tmpObj(i).cells(0).innerHTML;if((headStr.indexOf("I.gif")>-1)||(headStr.indexOf("blank.gif")>-1))_tArr.push("　");_tArr.push(tmpObj(i).cells(0).innerText+"</td>");for(j=1;j<len;j++)_tArr.push("<td class=xl24>"+tmpObj(i).cells(j).innerText+"</td>");_tArr.push("</tr>");};};};_tArr.push("</tbody></table>");return _tArr.join("");};function fj(param){var url=ga.location.search;var pos1=0,pos2=0;pos1=url.indexOf("&"+param+"=");if(pos1<0)pos1=url.indexOf("?"+param+"=");if(pos1>-1){pos2=url.indexOf("&",pos1+1);if(pos2==-1)pos2=url.length;return unescape(url.substring(pos1+param.length+2,pos2));}else return null;};function Trim(s){return s.replace(/(^\s*)|(\s*$)/g,"");};function fk(widthP){var widthF=parseFloat(widthP);return"<col style='mso-width-source:userset;mso-width-alt:"+(widthF*32)+";width:"+(widthF/1.333333333333333333333333)+"pt'>";};function fl(percentP){var tObjA=ga.document.body.children[0].children[0].children;if(!tObjA)return;for(var i=0;i<tObjA.length;i++){if(tObjA[i].style.width==""){alert("由于源表格没有宽度，设置宽度比例无效！");break;};tObjA[i].style.width=(parseFloat(tObjA[i].style.width)*percentP/100).toString()+"pt";};}
//-->
</script>