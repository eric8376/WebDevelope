<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>ztesfot</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
</head>
<link rel="stylesheet" type="text/css" href="../../style/base.css" />
<link rel="stylesheet" href="../../inc/other/tab/tab.css" type="text/css" media="screen">
<script type="text/javascript" src="../../inc/other/tab/tab.js"></script>
	
<script language="javascript" src="../../inc/json/json.js"></script>
<link rel="stylesheet" href="../../inc/other/table/table.css" type="text/css" media="screen">
<script type="text/javascript" src="../../inc/other/table/table.js"></script>

<body onload="init()" >
<div id="dhtml_tabView1"  style="width:100%;height:95%;">
	<div  width="100%" height="100%" id="tab1">
	<div id="coverdiv"  style="display:none;z-index:1000;filter:alpha(opacity=30);Opacity:0.3; background-color:#F8F4E2; position:absolute; left:5px; top:5px;width:100%;height:100%"></div>
    <div id="coverdiv-loading" style="display:none;z-index:1001; position:absolute; left:100px; top:200px;"><img src="../../images/loading.gif"/>数据加载...</div>
	<div  id="tableDiv" style="width:100%;height:100%;"> 
	        <table   id="scrollTable"  > 
	        <thead > 
            <TR >   
            <TD   nowrap style="width:150px" id="buzType" width="150px">业务类型</TD>   
            <TD   nowrap style="width:50px" id="oprState">状态</TD>   
            <TD   nowrap id="circuitNo" style="width:100px" width="100px">编号</TD>  
            <TD   nowrap id="rate" style="width:50px" >速率</TD> 
            <TD   nowrap id="formalCircuitNo" style="width:100px" >国际国内编码</TD> 
            <TD   nowrap id="route" style="width:600px" ><input  type="checkbox"  onclick="checkAll(this.checked)">路由</TD>  
           </TR>  
           </thead>
           <tbody id="scrollTable_tby">
           </tbody>
            </table> 

       </div> 

	</div>
	<div  id="tab2" width="100%" height="100%" style="display:none">
		<div  id="tableDiv2" style="width:100%;height:100%;"> 
	        <table   id="scrollTable2" >  
	        <thead>
            <TR>   
            <TD   nowrap style="width:150px" id="circuitNo">电路编号</TD>   
            <TD   nowrap style="width:150px" id="buzType">业务类型</TD>     
            <TD   nowrap style="width:150px" id="speciality">专业</TD>   
            <TD   nowrap style="width:200px" id="roomName">机房名称</TD>   
            <TD   nowrap  style="width:150px" id="eqpName">设备名称</TD>  
            <TD   nowrap  style="width:150px" id="eqpNo">设备编号</TD> 
            </TR>  
           </thead>
           <tbody id="scrollTable2_tby">
           </tbody>
            </table> 

</div> 
	</div>
	<div  id="tab5" width="100%" height="100%" style="display:none">
		<div  id="tableDiv5" style="width:100%;height:100%;"> 
	        <table   id="scrollTable5" >  
	        <thead>
            <TR>   
            <TD   nowrap style="width:80px" id="optBuzType">业务类型</TD>   
            <TD   nowrap style="width:100px" id="oprStateName">光路状态</TD>     
            <TD   nowrap style="width:150px" id="optRoadNo">光路编号</TD>   
            <TD   nowrap style="width:80px" id="rate">光路速率</TD>   
            <TD   nowrap  style="width:80px" id="optPairNum">光路芯数</TD>  
			<TD   nowrap style="width:600px" id="routeTextCur">路由</TD>  
            </TR>  
           </thead>
           <tbody id="scrollTable5_tby">
           </tbody>
            </table> 

		</div> 
	</div>
	<div  id="tab9" width="100%" height="100%" style="display:none">
		<div  id="tableDiv9" style="width:100%;height:100%;"> 
	        <table   id="scrollTable9" >  
	        <thead>
            <TR>   
            <TD   nowrap style="width:80px" id="eqpName">主要节点</TD>   
            <TD   nowrap style="width:100px" id="cirInfo">节点电路信息</TD>     
            <TD   nowrap style="width:150px" id="upperNode">上联网元</TD>   
            <TD   nowrap style="width:80px" id="protectType">保护方式</TD>   
            <TD   nowrap  style="width:80px" id="optInfo">光路情况</TD>  
            </TR>  
           </thead>
           <tbody id="scrollTable9_tby">
           </tbody>
            </table> 

		</div> 
	</div>
	<div  id="tab10" width="100%" height="100%" style="display:none">
		<div  id="tableDiv10" style="width:100%;height:100%;"> 
	        <table   id="scrollTable10" >  
	        <thead style="display:none">
            <TR>   
            <TD   nowrap style="width:120px" id="0">属性名称</TD>   
            <TD   nowrap style="width:120px" id="1">属性值</TD>                
            </TR>  
           </thead>
           <tbody id="scrollTable10_tby">
           </tbody>
            </table> 

		</div> 
	</div>	
	<div  width="100%" height="100%" id="tab3" style="display:none">
	 <iframe name="tuopFrame1" id="tuopFrame1" src="" frameborder=0 width="100%" height="100%" scrolling="auto"></iframe>
	</div>
	<div  width="100%" height="100%"id="tab4" style="display:none">
	 <iframe name="tuopFrame2" id="tuopFrame2" src="" frameborder=0 width="100%" height="100%" scrolling="auto"></iframe>
	</div>
	<div  width="100%" height="100%"id="tab6" style="display:none">
	 <iframe name="tuopFrame3" id="tuopFrame3" src="" frameborder=0 width="100%" height="100%" scrolling="auto"></iframe>
	</div>
	<div  width="100%" height="100%"id="tab7" style="display:none">
	 <iframe name="tuopFrame4" id="tuopFrame4" src="custlogo.html" frameborder=0 width="100%" height="100%" scrolling="auto"></iframe>
	</div>
	<div  width="100%" height="100%"id="tab8" style="display:none">
	 <iframe name="tuopFrame5" id="tuopFrame5" src="" frameborder=0 width="100%" height="100%" scrolling="auto"></iframe>
	</div>
	
</div>
<form style="margin:0 0 0 0" method="post" name="form1" id="form1" action="/RES/PrintServlet?printId=custCirQueryPrint">
</form>
</body>
</html>
<script type="text/javascript"><!--
var _last_custInfo=null;
var _tabDataExit=Array(false,false,false,false,false,false,false,false,false);
var S,_tb1,_tb2,_tb5,_tb9,_tb10,_custMap;
function initTabFroLOG(custInfo){
for(i=0;i<10;i++){
_tabDataExit[i]=false;
}
_last_custInfo=custInfo;
tabs.setActiveTab(1);
initActiveTab();
}

function initTab(custInfo){
for(i=0;i<10;i++){
_tabDataExit[i]=false;
}
_last_custInfo=custInfo;
initActiveTab();
}
function initActiveTab(){
//alert("in tavview");
  var tabIndex=tabs.getActiveTab();
  if(tabIndex==null || tabIndex<0)return;
  if(_tabDataExit[parseInt(tabIndex)]==true)return;
  switch(parseInt(tabIndex)){
  case 0:initGrid7();break;
  case 1:initGrid1();break;
  case 2:initGrid2();break;
  case 3:initGrid5();break;
  case 4:initGrid3();break;   
  case 5:initGrid4();break; 
  case 6:initGrid6();break;
  case 7:initGrid8();break;
  case 8:initGrid9();break;
  case 10:alert(1);    
  }
  _tabDataExit[parseInt(tabIndex)]=true;
}

function _dataItemDbClick(idstr){
			 
}
function showDiv(divIndex){
 document.getElementById("tab1").style.display="none";
 document.getElementById("tab2").style.display="none";
 document.getElementById("tab3").style.display="none";
 document.getElementById("tab4").style.display="none";
 document.getElementById("tab5").style.display="none";
 document.getElementById("tab6").style.display="none";
 document.getElementById("tab7").style.display="none";
 document.getElementById("tab8").style.display="none";
 document.getElementById("tab9").style.display="none";
 document.getElementById("tab10").style.display="none";
 document.getElementById("tab"+divIndex).style.display="block";
}
var routeCheckBoxValue = false;
var iputIds = new Array(0);
var arrayIndex=0;
var _chks_route=null;
function addRouteBtn(){

 if(tabs.getActiveTab()!=1) return;
 _chks_route=document.getElementsByName("routeCheckBox");
 iputIds = new Array(0);
 arrayIndex=0;
 for(i=0;i<_chks_route.length;i++){
   if(_chks_route[i].checked){
     addOneItemRoute(_chks_route[i].id.split("_")[1]);
     
   }
 }
}
function checkAll(isChecked){
 
 _chks_route=document.getElementsByName("routeCheckBox");
 for(i=0;i<_chks_route.length;i++)
    _chks_route[i].checked=isChecked;
}
function clkCBox(self,circuitId,i){
return;
if(self.checked==true){

    if(document.getElementById('rout_textArea_'+i).value.trim().length<=0){
     var serviceCallR = new ServiceCall();

      serviceCallR.init("txtRouteQrySvc");
      
      var route=serviceCallR.execute({"resType":"circuit","resId":circuitId});

      if(route!=null){
       document.getElementById('rout_textArea_'+i).value=route.replace(/<br>/ig,'\n');
       
      }
     
    }
    
   
 
}
}
function addOneItemRoute(itemNumber){
    if(document.getElementById('rout_textArea_'+itemNumber).value.trim().length<=0){
   
     var serviceCallR = new ServiceCall(true,getRouteResult);

      serviceCallR.init("txtRouteQrySvc2");
      var resType="circuit";
      var route=serviceCallR.execute({"inputId":itemNumber,"resType":resType,"resId":document.getElementById('circuitIdValue_'+itemNumber).value});
      /*
      if(route!=null){
       document.getElementById('rout_textArea_'+itemNumber).value=route.replace(/<br>/ig,'\n');
       
      }
   */  
    }
   
    
}
function getRouteResult(route){

  if(route!=null){
       document.getElementById('rout_textArea_'+route.inputId).value=route.value.replace(/<br>/ig,'\n');
      }
      
     
}
var rout_i=0;
function initRoute(){
   var lst = _tb1.getAllItems();
    for(i=0;i<lst.length;i++){
    
      var serviceCallR = new ServiceCall();

      serviceCallR.init("txtRouteQrySvc");
      var route=serviceCallR.execute({"resType":"circuit","resId":lst[i].circuitId.toString()});

      if(route!=null){
       document.getElementById('rout_textArea_'+i).value=route.replace(/<br>/ig,'\n');
       _tb1.focus();
      }
      
    }
}
function initRouteContent(route){
if(route!=null){
       document.getElementById("rout_textArea_"+rout_i).value=route.replace(/<br>/ig,'\n');
       
      }
}
function initGrid1(){
showDiv(1);
var custInfo=_last_custInfo;
if (custInfo==null)return;

//为了只初始化一次


if(_tabDataExit[1]==true)return;
_tabDataExit[1]=true;

var custId=custInfo.custId;
var dataType=custInfo.dataType;
   var condi=" and res_type_id<>1008"//1008代表数据来自裸光纤
   condi=condi+" and res_type_id<>2559"//过滤接入业务
   coverdivIsShow(true);
   var serviceCall = new ServiceCall(true,initData1);
   var obj=new Object();
   if(typeof(custId)=="undefined"||custId==null||custId==""){
   obj.sql="select distinct * from vw_dat_sh_cust_cir_query and 1=1";
   }else{
   obj.sql="select distinct * from vw_dat_sh_cust_cir_query where cust_id='"+custId+"'";
   if(dataType=="1"){
     obj.sql = "select distinct * from vw_dat_sh_cust_cir_query where cust_id='"+custId+"' and buz_type='"+custInfo.custName+"' ";
   }else if(dataType=="2"){
     obj.sql="select distinct * from vw_dat_sh_cust_cir_query where circuit_id='"+custInfo.circuitId+"' and cust_id='"+custId+"'";
     
   }  
   }
   obj.sql=obj.sql+condi
   serviceCall.init("queryDataSvc");
   serviceCall.execute(obj);
}
function initGrid5(){
showDiv(5);
var custInfo=_last_custInfo;
if (custInfo==null)return;

//alert(JSON.stringify(custInfo));
//为了只初始化一次


if(_tabDataExit[3]==true)return;
_tabDataExit[3]=true;

var custId=custInfo.custId;
var buzType=custInfo.buzType;
var dataType=custInfo.dataType;
   
   coverdivIsShow(true);
   var serviceCall = new ServiceCall(true,initData5);
   var obj=new Object();
  // obj.sql="no";
   if(buzType=="_ALL_TYPE_CIR"||buzType=="光纤"||buzType=="裸光纤")//opt_road 表中大部分a_cust_id为空。
   obj.sql = "select distinct sf_get_desc_china(a.opr_state_id) opr_State_Name,a.* from opt_road a where a.delete_state='0' and  a.opt_road_id in( select circuit_id from vw_dat_sh_cust_cir_query where (buz_type='光纤' or buz_type='裸光纤') and cust_id='"+custId+"')";
   if(dataType=="2"){
  	obj.sql ="select distinct sf_get_desc_china(a.opr_state_id) opr_State_Name,a.* from opt_road a	where a.delete_state='0' and a.opt_road_id='"+custInfo.circuitId+"' ";
   }
   if(obj.sql==null){initData5();return}
   serviceCall.init("queryDataSvc");
   serviceCall.execute(obj);
}
function initData5(rt){
  
  if(rt!=null && rt.list && rt.list.length>0){
  	for(i=0;i<rt.list.length;i++){
  		rt.list[i].optBuzType='光纤';
  		if(rt.list[i].rate.length<=0)
  		rt.list[i].rate='&nbsp;';
  	}
  	var len=rt.list.length;
  	
    _tb5.loadData(rt.list);
   
    
  }else{
  _tb5.clearn();
  }
  
   coverdivIsShow(false); 
  
}
function initData1(rt){
  
  if(rt!=null && rt.list && rt.list.length>0){
  	for(i=0;i<rt.list.length;i++){
  		if(rt.list[i].formalCircuitNo.length<=0)
  		rt.list[i].formalCircuitNo='&nbsp;';
  		rt.list[i].route="<input  type='checkbox' name='routeCheckBox' id='routeCheckBox_"+i+"' onclick='clkCBox(this,\""+rt.list[i].circuitId.toString()+"\","+i+")'><input type='hidden' id='circuitIdValue_"+i+"' value='"+rt.list[i].circuitId.toString()+"'><input type='text' style='width:90%;border:1px;'  name='rout_textArea_"+i+"' id='rout_textArea_"+i+"' readonly>";
  	}
  	var len=rt.list.length;
  	
    _tb1.loadData(rt.list);
    /*
    for(i=0;i<len;i++){
      var serviceCallR = new ServiceCall();
      serviceCallR.init("txtRouteQrySvc");
      var route=serviceCallR.execute({"resType":"circuit","resId":rt.list[i].circuitId.toString()});
      if(route!=null){
      	//alert(route);
       document.getElementById("rout_textArea_"+i).value=route.replace(/<br>/ig,'\n');
      }
    }
    */
    //_tb1.loadData(rt.list);
    
  }else{
  _tb1.clearn();
  }
  
   coverdivIsShow(false); 
  
}

function initGrid2(){
 showDiv(2);
  
var custInfo=_last_custInfo;
//alert("custInfo="+custInfo);
if (custInfo==null)return null;
if(_tabDataExit[2]==true)return null;
_tabDataExit[2]=true;

   var custId = custInfo.custId;
   coverdivIsShow(true);
   var serviceCall = new ServiceCall();
   var obj=new Object();
   if(typeof(custId)=="undefined"||custId==null||custId==""){
   obj.sql="select * from vw_dat_sh_cust_cir_eqp ";
   }else{
   obj.sql="select * from vw_dat_sh_cust_cir_eqp where cust_id='"+custId+"' ";
  
    if(custInfo.buzType!=null && custInfo.buzType!="_ALL_TYPE_CIR")
      obj.sql+=" and buz_type='"+custInfo.buzType+"' "; 
    if(custInfo.circuitId!=null && custInfo.circuitId.length>0)
       obj.sql+=" and circuit_Id='"+custInfo.circuitId+"' ";  
   }
   
   serviceCall.init("queryDataSvc");
   var rt= serviceCall.execute(obj);
    

   if(rt!=null && rt.list && rt.list.length>0)
    _tb2.loadData(rt.list);
    else
     _tb2.clearn();
 
   coverdivIsShow(false); 

}



function initGrid3(){
showDiv(3);
var custInfo=_last_custInfo;
if (custInfo==null)return;

//为了只初始化一次


//if(_tabDataExit[2]==true)return;
//_tabDataExit[2]=true;
  
   //if(!custInfo.dataType ||custInfo.dataType!="2") return;
 
   var serviceCall = new ServiceCall();
   var code=custInfo.custId+"*";
   if(custInfo.buzType!="_ALL_TYPE_CIR"){
   var obj=new Object();
   obj.sql="select code from pub_restriction where keyword='RENT_CIRCUIT_PROPERTY' and   desc_china='"+custInfo.buzType+"'";
   serviceCall.init("queryDataSvc");
   var o= serviceCall.execute(obj); 
  
   if(o.list && o.list.length && o.list[0].code!=null){
     code=custInfo.custId+"*"+o.list[0].code;
     }
    }
    var oo=new Object();
    oo.sTopDefId="700012";
    oo.sSysLayerType="vip_room";
    oo.sResId=code;
    oo.tableSqlMap="resShCir.maplayerIdSql";
    serviceCall.init("queryForDtoSvc");
    var oo2= serviceCall.execute(oo); 
    if(oo2 && oo2.maplayerId){
   // window.prompt("",oo2.maplayerId);
     frames["tuopFrame1"].location.href ="tuopo.html?mapLayerId="+oo2.maplayerId+"&sSysLayerType=vip_room&RootId="+code+"&sTopDefId=700012&NodeParams="+code;
    }else{
     //frames["tuopFrame1"].location.href ="tuopo.html?sSysLayerType=vip_room&RootId="+code+"&sTopDefId=700012";
       frames["tuopFrame1"].location.href ="noTuopo.html";
    
    }
 
}

function initGrid4(){
showDiv(4);
var custInfo=_last_custInfo;
if (custInfo==null)return;
//alert(JSON.stringify(custInfo));
//为了只初始化一次


//if(_tabDataExit[3]==true)return;
//_tabDataExit[3]=true;
  
   //if(!custInfo.dataType ||custInfo.dataType!="2") return;
   
   var serviceCall = new ServiceCall();
   var code=custInfo.custId+"*";
   if(custInfo.buzType!="_ALL_TYPE_CIR"){
   var obj=new Object();
   obj.sql="select code from pub_restriction where keyword='RENT_CIRCUIT_PROPERTY' and   desc_china='"+custInfo.buzType+"'";
   serviceCall.init("queryDataSvc");
   var o= serviceCall.execute(obj); 
  
   if(o.list && o.list.length && o.list[0].code!=null){
     code=custInfo.custId+"*"+o.list[0].code;
     }
    }
    var oo=new Object();
    oo.sTopDefId="700013";
    oo.sSysLayerType="vip_ne";
    oo.sResId=code;
    oo.tableSqlMap="resShCir.maplayerIdSql";
    serviceCall.init("queryForDtoSvc");
    var oo2= serviceCall.execute(oo); 
    if(oo2 && oo2.maplayerId){
     frames["tuopFrame2"].location.href ="tuopo.html?mapLayerId="+oo2.maplayerId;
    
     //frames["tuopFrame2"].location.href ="tuopo.html?mapLayerId="+oo2.maplayerId;
    }else{
       frames["tuopFrame2"].location.href ="noTuopo.html";
    
    }    
    

 }
 function initGrid9(){
 	showDiv(9);
  
	var custInfo=_last_custInfo;
	//alert(JSON.stringify(custInfo));
	if (custInfo==null)return null;
	//if(_tabDataExit[8]==true)return null;
	//_tabDataExit[8]=true;
   var custId = custInfo.custId;
   coverdivIsShow(true);
   var serviceCall = new ServiceCall();
   var obj=new Object();  
  
   	obj.sql="select * from VW_DAT_SH_CUST_EQP_DESC t where t.cust_id in (select distinct p.parent_id from pub_cust p where p.cust_id='"+custId+"' or p.parent_id='"+custId+"')";

  alert(obj.sql);
   serviceCall.init("queryDataSvc");
   var rt= serviceCall.execute(obj);
   alert(rt.list.length);
   if(rt!=null && rt.list && rt.list.length>0){
   	for(i=0;i<rt.list.length;i++){   
  		if(rt.list[i].cirInfo.length<=0)
  		rt.list[i].cirInfo='&nbsp;';
  		if(rt.list[i].upperNode.length<=0)
  		rt.list[i].upperNode='&nbsp;';
  		if(rt.list[i].protectType.length<=0)
  		rt.list[i].protectType='&nbsp;';
  		if(rt.list[i].optInfo.length<=0)
  		rt.list[i].optInfo='&nbsp;'; 
  	}
  
     _tb9.loadData(rt.list);

   } else
     _tb9.clearn(); 
   coverdivIsShow(false); 
 }
 function initGrid10(){
 	showDiv(10);
 	var custInfo=_last_custInfo;
 	//alert(JSON.stringify(custInfo));
	if (custInfo==null)return null;

   var custId = custInfo.custId;
   var serviceCall = new ServiceCall();
   var obj=new Object();
   obj.sql="select t.cust_name, "+
        "  t.cust_no,                                                                  " +
		" (select type_name                                                            " +     
		"    from Pub_Cust_Type                                                        " +     
		"   where cust_type_id =                                                       " +     
		"  (select cust_type_id from PUB_cust where cust_id in "                         +     
		"(select distinct p.parent_id from pub_cust p where p.cust_id='"+custId+"' or "  +     
		" p.parent_id='"+custId+"'))) as type_name, "                                     +     
		" t.spell,                                                                     " +     
		" t.link_man,                                                                  " +     
		" t.link_tele,                                                                 " +     
		" t.email,                                                                     " +     
		" t.address,                                                                   " +     
		" t.zip,                                                                       " +     
		" t.grade,                                                                     " +     
		" decode(t.status, '0', '可用', '1', '不可用') status,                         " +     
		" t.memo,                                                                      " +     
		" t.pact_cust_name_ch,                                                         " +     
		" t.pact_cust_name_en,                                                         " +     
		" t.other_cust_name_ch,                                                        " +     
		" t.other_cust_name_en,                                                        " +     
		" t.parent_id,                                                                 " +     
		" decode(t.consume_level, '0', '否', '1', '是') consume_level,                 " +     
		" t.notes                                                                      " +     
  		" from PUB_cust t  "         +                                                        
 		"where t.CUST_ID in (select distinct p.parent_id from pub_cust p where p.cust_id='"+custId+"' or p.parent_id='"+custId+"')";  
   serviceCall.init("queryDataSvc");
   var rt= serviceCall.execute(obj);
    

   if(rt!=null && rt.list && rt.list.length>0)
   { 
   var test=new Array();
   var str0='{"0":"客户名称","1":"&nbsp;'+rt.list[0].custName+'"}';
   var str1='{"0":"客户编号","1":"&nbsp;'+rt.list[0].custNo+'"}';
   var str2='{"0":"客户类型","1":"&nbsp;'+rt.list[0].typeName+'"}';
   var str3='{"0":"名称简拼","1":"&nbsp;'+rt.list[0].spell+'"}';
   var str4='{"0":"联系人","1":"&nbsp;'+rt.list[0].linkMan+'"}';
   var str5='{"0":"联系电话","1":"&nbsp;'+rt.list[0].linkTele+'"}';
   var str6='{"0":"邮件地址","1":"&nbsp;'+rt.list[0].email+'"}';
   var str7='{"0":"联系地址","1":"&nbsp;'+rt.list[0].address+'"}';
   var str8='{"0":"邮编","1":"&nbsp;'+rt.list[0].zip+'"}';
   var str9='{"0":"客户等级","1":"&nbsp;'+rt.list[0].grade+'"}';
  var str10='{"0":"状态","1":"&nbsp;'+rt.list[0].status+'"}';
  var str11='{"0":"备注","1":"&nbsp;'+rt.list[0].memo+'"}';
  var str12='{"0":"合同主体名称(中文)","1":"&nbsp;'+rt.list[0].pactCustNameCh+'"}';
  var str13='{"0":"合同主体名称(英文)","1":"&nbsp;'+rt.list[0].pactCustNameEn+'"}';
  var str14='{"0":"其他公司名称(中文)","1":"&nbsp;'+rt.list[0].otherCustNameCh+'"}';
  var str15='{"0":"其他公司名称(英文)","1":"&nbsp;'+rt.list[0].otherCustNameEn+'"}';
  var str16='{"0":"归属名","1":"&nbsp;'+rt.list[0].parentId+'"}';
  var str17='{"0":"是否客户归属名","1":"&nbsp;'+rt.list[0].consumeLevel+'"}';
  var str18='{"0":"logo","1":"&nbsp;'+rt.list[0].notes+'"}';                                                                             
  for( i=0;i<19;i++){
  	test[i]=JSON.parse(eval("str"+i));
  }                       
     _tb10.loadData(test);
  }
   coverdivIsShow(false); 
 }
 
 //拓扑云图
 function initGrid8(){
	showDiv(8);
	var custInfo=_last_custInfo;
	//if(typeof(custInfo.dataType)!="undefined")alert("请选择所归属的客户查看拓扑云图");
	if (custInfo==null||custInfo.custId==null){frames["tuopFrame5"].location.href ="noTuopo.html";return;}
    var serviceCall = new ServiceCall();
    var oo=new Object();
    oo.sTopDefId="700016";
    oo.sSysLayerType="cloud";
    oo.sResId=custInfo.custId;
    oo.tableSqlMap="resShCir.maplayerIdSql";
    serviceCall.init("queryForDtoSvc");

    var oo2= serviceCall.execute(oo); 
    if(oo2 && oo2.maplayerId){
     frames["tuopFrame5"].location.href ="tuopo.html?mapLayerId="+oo2.maplayerId;   
    }else
    {  frames["tuopFrame5"].location.href ="noTuopo.html";
    }    
     } 
function initGrid6(){
showDiv(6);
var custInfo=_last_custInfo;
if (custInfo==null||custInfo.circuitId==null){frames["tuopFrame3"].location.href ="noTuopo.html";return;}
   var serviceCall = new ServiceCall();
    var code=custInfo.circuitId+";430008";
    var oo=new Object();
    oo.sTopDefId="430008";
    oo.sSysLayerType="ROADROUTE";
    oo.sResId=custInfo.circuitId;
   // prompt("",custInfo.circuitId);
    if(custInfo.buzType=='光纤'||custInfo.buzType=='裸光纤' )oo.tableSqlMap="resShCir.maplayerIdSql";
    else oo.tableSqlMap="resShCir.maplayerIdSql";
    serviceCall.init("queryForDtoSvc");

    var oo2= serviceCall.execute(oo); 
    if(oo2 && oo2.maplayerId){
     frames["tuopFrame3"].location.href ="tuopo.html?mapLayerId="+oo2.maplayerId+"&sResId="+
     custInfo.circuitId+"&sSysLayerType=ROADROUTE&RootId="+custInfo.circuitId+"&sTopDefId=430008&NodeParams="+code;
    }else{
       frames["tuopFrame3"].location.href ="noTuopo.html";
    
    }    
     } 
  function showLogo(custMap){
    _custMap=custMap;
    //alert(JSON.stringify(_custMap.list[1]))
    for(i=0;i<custMap.list.length;i++){
    	alert(JSON.stringify(_custMap.list[i]));
    }
    frames["tuopFrame4"].location.href ="custlogo.html?custMap="+custMap;
   // initGrid7();
  
   
  }
 function initGrid7(){
 	showDiv(7);
 	//tabs.setActiveTab(6);
	//frames["tuopFrame4"].location.href ="custlogo.html?custMap="+_custMap;
     } 
function init(){	
    var height0 = document.body.parentNode.clientHeight-40;
    document.getElementById("tableDiv").style.height=height0+"px";
    document.getElementById("tableDiv2").style.height=height0+"px";
    document.getElementById("tableDiv5").style.height=height0+"px";
    document.getElementById("tab3").style.height=height0+"px";
    document.getElementById("tab4").style.height=height0+"px";
    document.getElementById("tab6").style.height=height0+"px";
    document.getElementById("tab7").style.height=height0+"px";
    document.getElementById("tab8").style.height=height0+"px";
    document.getElementById("tab9").style.height=height0+"px";
    document.getElementById("tab10").style.height=height0+"px";
    //Array('tab1','tab2','tab3','tab4')
    tabs = new Tabs("dhtml_tabView1",Array('LOGO视图','电路列表','两端设备列表','裸光纤业务','机房拓扑图','传输网元拓扑图','光纤拓扑图','拓扑云图','网络描述','客户信息'),0,null,"../../inc/other/tab/",Array(initGrid7,initGrid1,initGrid2,initGrid5,initGrid3,initGrid4,initGrid6,initGrid8,initGrid9,initGrid10));
    tabs.addButton("导出数据",printData);
    tabs.addButton("加载电路路由",addRouteBtn);
    _tb1=new DataGrid("tableDiv","scrollTable",{});

    _tb2=new DataGrid("tableDiv2","scrollTable2",{});
    _tb5=new DataGrid("tableDiv5","scrollTable5",{});
    _tb9=new DataGrid("tableDiv9","scrollTable9",{});
    _tb10=new DataGrid("tableDiv10","scrollTable10",{});
    a=1;
	//var treeItem=window.parent.document.frames['lfefFrame'].getSelectedItemData();
	tabs.setActiveTab(0);
	//if(treeItem!=null){
	//_last_custInfo=treeItem.data;
	//initActiveTab();
	
	//}else initActiveTab();
	initActiveTab();
	window.parent.changeDivWidth();
	
	window.parent.changeDivWidth();
	}
	
function coverdivIsShow(isShow){
 if(typeof(isShow)=="undefined"||isShow==null||isShow==false){
  document.getElementById("coverdiv").style.display="none";
  document.getElementById("coverdiv-loading").style.display="none";
 }else{
  document.getElementById("coverdiv").style.display="block";
  document.getElementById("coverdiv-loading").style.display="block";
 }
}	

function printData(){
var custInfo=_last_custInfo;
if (custInfo==null){
alert("请选择一个客户");
return;
}
var custId=custInfo.custId;
var dataType=custInfo.dataType;
var advQueryC=" where cust_id='"+custId+"' ";//电路列表
   if(dataType=="1"){
     advQueryC = " where cust_id='"+custId+"' and buz_type='"+custInfo.custName+"' ";
   }else if(dataType=="2"){
     advQueryC=" where circuit_id='"+custInfo.circuitId+"' and cust_id='"+custId+"'";
     
   } 
   var condi=" and res_type_id<>1008"//1008代表数据来自裸光纤
   advQueryC=advQueryC+condi;
var advQueryC2=" where cust_id='"+custId+"' ";//设备两端
  
    if(custInfo.buzType!=null && custInfo.buzType!="_ALL_TYPE_CIR")
      advQueryC2+=" and buz_type='"+custInfo.buzType+"' "; 
    if(custInfo.circuitId!=null && custInfo.circuitId.length>0)
       advQueryC2+=" and circuit_Id='"+custInfo.circuitId+"' ";  
       
 var advQueryC3 =" where a.delete_state='0'";//裸光纤      
 // if(custInfo.buzType=="_ALL_TYPE_CIR"||buzType=="光纤")//opt_road 表中大部分a_cust_id为空。
 //  obj.sql = "  and  a.opt_road_id in( select circuit_id from vw_dat_sh_cust_cir_query where buz_type='光纤' and cust_id='"+custId+"')";
   if(dataType=="2"){
  	advQueryC3+=" and a.opt_road_id='"+custInfo.circuitId+"' ";
   }else if(custInfo.buzType=="_ALL_TYPE_CIR"||custInfo.buzType=="光纤"||custInfo.buzType=="裸光纤") advQueryC3+= "  and  a.opt_road_id in( select circuit_id from vw_dat_sh_cust_cir_query where (buz_type='光纤' or buz_type='裸光纤') and cust_id='"+custId+"')";
 	else advQueryC3+=" and a.delete_state<>'0'" //此种情况无相关数据
  
//var date=(new Date()).getTime();
//alert("date="+new Date());
//alert("datetime="+(new Date()).getTime());
//alert("&advQueryC="+advQueryC+"&advQueryC2="+advQueryC2+"&advQueryC3="+advQueryC3+"&math="+Math.random());
document.getElementById('form1').action=document.getElementById('form1').action+"&advQueryC="+advQueryC+"&advQueryC2="+advQueryC2+"&advQueryC3="+advQueryC3+"&a"+(new Date()).getTime();
document.getElementById('form1').submit();
document.getElementById('form1').action="/RES/PrintServlet?printId=custCirQueryPrint";
}
--></script>
