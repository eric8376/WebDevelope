<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>设备</title>
</head>
<link rel="stylesheet" href="css/integerate.css" type="text/css">
<script type="text/javascript" src="js/ajax.js"></script>
<script type="text/javascript" src="js/tab-view.js"></script>
<link rel="STYLESHEET" type="text/css" href="../../inc/dhtmlxGrid/css/dhtmlXGrid.css"> 
<script src="../../inc/dhtmlxGrid/js/dhtmlXCommon.js"></script>
<script src="../../inc/dhtmlxGrid/js/dhtmlXGrid.js"></script> 
<script src="../../inc/dhtmlxGrid/js/dhtmlXGridCell.js"></script>
<script language="javascript" type="text/javascript" src="../../inc/js/formUtils.js"></script>
<script src="../../inc/json/json.js"></script>

<script language="javascript" type="text/javascript" src="js/integrateQuery.js"></script>
<script language="javascript" type="text/javascript" src="js/popWin.js"></script>
<style>
.span{
FONT-SIZE: 12px; CURSOR: hand; COLOR:#0b2c67;
}
body table{
FONT-SIZE: 12px;
}
</style>
<body onload="init()"  >
<div position:absolute; left:6px; top:2px;height:90px;width:99%;background-color: #F8F3F7;">
<form id="qryCondition">
<table style="background-color: #F8F3F7;">
<tr>
<td width="20%">设备编号</td><td width="30%"><input type="text" id="eqpNo"></td>
<td width="20%">设备名称</td><td width="30%"><input type="text" id="eqpName"></td>
</tr>
<tr>
<td>设备类型</td><td><select id="eqpTypeName" style="width:155px"><option value=""></option></select></td>
<td>局站编号</td><td><input type="text" id="stationNo">
<!--  
<td>专业类型</td><td>
<select id="speciality" style="width:155px">
<option value=""></option>
</select>
</td>
-->
</tr>
<tr>
<td>设备型号</td><td><select id="eqpModelName" style="width:155px"><option value=""></option></select></td>
<td>资源对象ID</td><td><input type="text" id="resTypeId"><input class="button_blue" type="button" value="查询" onclick="query()"></td>
</tr>
<!--  
<tr><td>局站编号</td><td><input type="text" id="stationNo"></td><td colspan="2"><input class="button_blue" type="button" value="查询" onclick="query()"></td></tr>
-->
</table>
</form>

</div>
<div id="eqpGridbox" style="background-color:white;overflow:hidden;border:0px solid blue;position:absolute; left:6px; top:85px;height:370px;width:99%;"></div> 

<div id="staticDiv" style="position:absolute; left:2px; top:465px;height:9px;width:95%;text-align:right;background-color: #F8F3F7;">
<span class="span_mouseout" id="pageInfoSpan"></span>&nbsp;&nbsp;&nbsp;&nbsp;
<span onclick="dataList.firstPage();query();" class="span">首页</span> 
<span onclick="dataList.prePage();query();" class="span">上一页</span>
<span onclick="dataList.nextPage();query();" class="span">下一页</span>
<span onclick="dataList.lastPage();query();" class="span">末页</span>
</div>
<div id="confirmDiv" style="position:absolute; left:2px; top:485px;height:9px;width:95%;text-align:center;background-color: #F8F3F7;">
<input style='width:65px;align:right' class="button_blue" type="button" id="queryBtn" value='确定' onclick="okBtnClick(eqpGrid)">
<input style='width:65px;align:right' class="button_blue" type="button" id="queryBtn" value='取消' onclick="window.close();">
</div>
<!--  
<div algin="right" style="position:absolute; left:6px; top:465px;height:18px;width:99%;text-align:right"><span id="pageInfoSpan"></span>&nbsp;&nbsp;<span class="span" onclick="firtPage()">首页</span>&nbsp;&nbsp;<span class="span" onclick="pref()">上一页</span>&nbsp;&nbsp;<span class="span" onclick="next()">后一页</span>&nbsp;&nbsp;</div>
<div algin="center" style="position:absolute; left:6px; top:490px;height:18px;width:99%;text-align:center"><input type="button" value="确定" onclick="rtData()" ><input type="button" value="取消" onclick="window.close()"></div>
-->
</body>
</html>
<script>
var pageIndex=0;
var pageSize="20";
var dataList=new DataList(null,0,20,1);
var roomId=null;
function init(){
	 eqpGrid = new dhtmlXGridObject('eqpGridbox');
	 eqpGrid.setImagePath("../../inc/dhtmlxGrid/imgs/");
	 eqpGrid.setHeader("设备编号,设备名称,资源对象ID,设备类型,设备型号,局站编号"); 
	 eqpGrid.setInitWidths("120,120,120,120,120,120")
	 eqpGrid.setColAlign("left,left,left,left,left,left")
	 eqpGrid.setColShow("block,block,block,block,block,block");
	 eqpGrid.setColId("eqpNo,eqpName,resTypeId,eqpTypeName,eqpModelName,stationNo")
	 //eqpGrid.setMultiselect(true) 
	 eqpGrid.setColTypes("ro,ro,ro,ro,ro,ro"); 
	 eqpGrid.setColSorting("str,str,str,str,str,str")
	 eqpGrid.init();
	 eqpGrid.setDblClick(_dataItemDbClick);
	 document.all.pageInfoSpan.innerHTML="每页<input type='text' style='height:18px;width:24px' id='pageCount' value='"+dataList.count+"'>条 总共"+dataList.total+"条 第"+dataList.pageNo+"/"+dataList.maxPageNo+"页";	 	 	 
	 //setSelecttion("speciality",querySpecial(),"speciality","speciality");
	 setSelecttion("eqpTypeName",queryEqpType(),"eqpType","eqpType");
	 setSelecttion("eqpModelName",queryEqpModel(),"eqpModel","eqpModel");
}

function querySpecial(){
	var serviceCall = new ServiceCall();
	 var obj=new Object();
	 obj.viewName='pub_speciality';
	 obj.advQueryC=" speciality_id in (43,44,45,50,60,70,80,90,100,120,10001) and delete_state = 0 ";
	 serviceCall.init("queryForListSvc");
	 var list=serviceCall.execute(obj);
	 if(list&&list.length)return list;
	 return null;
}

function queryEqpType(){
	var serviceCall = new ServiceCall();
	 var obj=new Object();
	 obj.viewName='RME_EQP_TYPE';
	 obj.advQueryC=" EQP_TYPE_ID=5003 order by EQP_TYPE  asc";
	 serviceCall.init("queryForListSvc");
	 var list=serviceCall.execute(obj);
	 if(list&&list.length)return list;
	 return null;
}

function queryEqpModel(){
	var serviceCall = new ServiceCall();
	 var obj=new Object();
	 obj.viewName='RME_EQP_MODEL';
	 obj.advQueryC=" eqp_type_id in(5003) order by EQP_MODEL  asc";
	 serviceCall.init("queryForListSvc");
	 var list=serviceCall.execute(obj);
	 if(list&&list.length)return list;
	 return null;
}

function query(page){
	 dataList.count=parseInt(document.all.pageCount.value);
	 var serviceCall = new ServiceCall(); 
	 
	 var obj=new Object();
	 obj.pageIndex=dataList.pageNo.toString();//第几页
	 obj.pageSize=dataList.count.toString();//每页大小

	var fm=new FormUtil(eval("qryCondition"));
	var formInfo=fm.getData();
	for(key in formInfo){
		if(formInfo[key]!="")obj[key]=formInfo[key];
	}
	obj.needFieldConvert="1";
	obj.tableSqlMap="CircuitQuery.selectEqpStep";
	obj.tableCountSqlMap="CircuitQuery.selectEqpCount";
	serviceCall.init("queryForStepSvc");
	 var map=serviceCall.execute(obj);
	 if(map&&map.pageCount){
	 	dataList.maxPageNo=map.pageCount;
	 	dataList.total=map.recordCount;	
	 }else{
	 	dataList.maxPageNo=0;
	 	dataList.total=0;	 
	 }
	 if(!map||!map.list||!map.list.length)eqpGrid.clearAll();
	 else eqpGrid.loadData(map.list);
	 document.all.pageInfoSpan.innerHTML="每页<input type='text' style='height:18px;width:24px' id='pageCount' value='"+dataList.count+"'>条 总共"+dataList.total+"条 第"+dataList.pageNo+"/"+dataList.maxPageNo+"页";
	return 0;
}
/*
function rtData(grid){
	var id=grid.getSelectedId();
	if(!id||id==""){
		alert("还没选择设备,请选择一条数据，然后点击\"确定\"。");
		return;
	}
	var itemRow=grid.getRowById(parseInt(id));
	var itemRowValue=itemRow.grid.gridDataArray[itemRow.idd-1];
	window.returnValue= {"eqpName":itemRowValue.eqpName};
	window.close();
}

function doubleClickData(rowObj){
	window.returnValue= {"eqpName":rowObj.eqpName};
	window.close();
}

function firtPage(){
if(parseInt(pageIndex)==1)return;
else query(1);
}
function next(){
if(pageCount==null)return;
if(pageIndex.toString()==pageCount.toString())return;
if(parseInt(pageIndex)+1<=parseInt(pageCount)){
query(parseInt(pageIndex)+1);
}
}
function pref(){
if(pageCount==null)return;
if(parseInt(pageIndex)==1)return;
if(parseInt(pageIndex)-1>0){
query(parseInt(pageIndex)-1);
}
}
String.prototype.trim = function() {
   return this.replace(/(^\s*)|(\s*$)/g, "");
}
function GetUrlParameter(param){
  var url = window.location.search;
  var pos1 = 0, pos2 = 0;
  pos1 = url.indexOf("&"+ param +"=");
  if(pos1<0) pos1 = url.indexOf("?"+ param +"=");
  if(pos1>-1){
    pos2 = url.indexOf("&",pos1+1);
    if(pos2==-1) pos2 = url.length;
    return unescape(url.substring(pos1+param.length+2, pos2));
  }else return null;
}
*/
</script>